<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Main</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption empty">&nbsp;</span><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>Jo&#227;o Magalh&#227;es &lt;a100740@alunos.uminho.pt&gt;;<br />: Gon&#231;alo Loureiro &lt;a100535@alunos.uminho.pt&gt;;</td></tr><tr><th>Safe Haskell</th><td>None</td></tr></table><p class="caption">Main</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>M&#243;dulo para a realiza&#231;&#227;o da Tarefa 5 do projeto de LI1 em 2021/22.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">type</span> <a href="#t:Estado">Estado</a> = (Float, Float)</li><li class="src short"><span class="keyword">type</span> <a href="#t:EstadoGloss">EstadoGloss</a> = (<a href="LI12122.html#t:Jogo" title="LI12122">Jogo</a>, <a href="Main.html#t:Estado" title="Main">Estado</a>, (<a href="Main.html#t:Menu" title="Main">Menu</a>, [Picture]))</li><li class="src short"><span class="keyword">data</span> <a href="#t:Menu">Menu</a><ul class="subs"><li>= <a href="#v:MainMenu">MainMenu</a></li><li>| <a href="#v:Jogar">Jogar</a></li><li>| <a href="#v:Continuar">Continuar</a></li><li>| <a href="#v:Mapas">Mapas</a></li><li>| <a href="#v:Instrucoes">Instrucoes</a></li><li>| <a href="#v:Sair">Sair</a></li></ul></li><li class="src short"><a href="#v:estadoInicial">estadoInicial</a> :: <a href="Main.html#t:Estado" title="Main">Estado</a></li><li class="src short"><a href="#v:estadoGlossInicial">estadoGlossInicial</a> :: [Picture] -&gt; <a href="Main.html#t:EstadoGloss" title="Main">EstadoGloss</a></li><li class="src short"><a href="#v:reageEventoGloss">reageEventoGloss</a> :: Event -&gt; <a href="Main.html#t:EstadoGloss" title="Main">EstadoGloss</a> -&gt; IO <a href="Main.html#t:EstadoGloss" title="Main">EstadoGloss</a></li><li class="src short"><a href="#v:coordPorta">coordPorta</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a></li><li class="src short"><a href="#v:reageTempoGloss">reageTempoGloss</a> :: Float -&gt; <a href="Main.html#t:EstadoGloss" title="Main">EstadoGloss</a> -&gt; IO <a href="Main.html#t:EstadoGloss" title="Main">EstadoGloss</a></li><li class="src short"><a href="#v:desenhaEstadoGloss">desenhaEstadoGloss</a> :: <a href="Main.html#t:EstadoGloss" title="Main">EstadoGloss</a> -&gt; IO Picture</li><li class="src short"><a href="#v:desenhaMapa">desenhaMapa</a> :: <a href="LI12122.html#t:Mapa" title="LI12122">Mapa</a> -&gt; Int -&gt; [Picture] -&gt; [Picture]</li><li class="src short"><a href="#v:desenhaLinha">desenhaLinha</a> :: [<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>] -&gt; (Int, Int) -&gt; (Int, Int) -&gt; [Picture] -&gt; [Picture]</li><li class="src short"><a href="#v:desenhaJogador">desenhaJogador</a> :: <a href="Main.html#t:EstadoGloss" title="Main">EstadoGloss</a> -&gt; Picture</li><li class="src short"><a href="#v:fr">fr</a> :: Int</li><li class="src short"><a href="#v:main">main</a> :: IO ()</li><li class="src short"><a href="#v:menu">menu</a> :: [Picture]</li><li class="src short"><a href="#v:jogo1">jogo1</a> :: <a href="LI12122.html#t:Jogo" title="LI12122">Jogo</a></li><li class="src short"><a href="#v:mapa1">mapa1</a> :: [[<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>]]</li><li class="src short"><a href="#v:jogo2">jogo2</a> :: <a href="LI12122.html#t:Jogo" title="LI12122">Jogo</a></li><li class="src short"><a href="#v:mapa2">mapa2</a> :: [[<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>]]</li><li class="src short"><a href="#v:jogo3">jogo3</a> :: <a href="LI12122.html#t:Jogo" title="LI12122">Jogo</a></li><li class="src short"><a href="#v:mapa3">mapa3</a> :: [[<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>]]</li><li class="src short"><a href="#v:jogo4">jogo4</a> :: <a href="LI12122.html#t:Jogo" title="LI12122">Jogo</a></li><li class="src short"><a href="#v:mapa4">mapa4</a> :: [[<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>]]</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Estado" class="def">Estado</a> = (Float, Float) <a href="#t:Estado" class="selflink">#</a></p><div class="doc"><p>Coordenadas dos objetos que ligam o utilizador ao jogo que, neste caso, &#233; a seta do menu principal e o quadrado no menu dos mapas.</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:EstadoGloss" class="def">EstadoGloss</a> = (<a href="LI12122.html#t:Jogo" title="LI12122">Jogo</a>, <a href="Main.html#t:Estado" title="Main">Estado</a>, (<a href="Main.html#t:Menu" title="Main">Menu</a>, [Picture])) <a href="#t:EstadoGloss" class="selflink">#</a></p><div class="doc"><p>Estado de um jogo.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Menu" class="def">Menu</a> <a href="#t:Menu" class="selflink">#</a></p><div class="doc"><p>Os v&#225;rios menus que o jogo possui. </p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:MainMenu" class="def">MainMenu</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:Jogar" class="def">Jogar</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:Continuar" class="def">Continuar</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:Mapas" class="def">Mapas</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:Instrucoes" class="def">Instrucoes</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:Sair" class="def">Sair</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:Menu">Instances</h4><details id="i:Menu" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Menu:Eq:1"></span> Eq <a href="Main.html#t:Menu" title="Main">Menu</a></span> <a href="#t:Menu" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Menu:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Main.html">Main</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Main.html#t:Menu" title="Main">Menu</a> -&gt; <a href="Main.html#t:Menu" title="Main">Menu</a> -&gt; Bool</p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Main.html#t:Menu" title="Main">Menu</a> -&gt; <a href="Main.html#t:Menu" title="Main">Menu</a> -&gt; Bool</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Menu:Show:2"></span> Show <a href="Main.html#t:Menu" title="Main">Menu</a></span> <a href="#t:Menu" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Menu:Show:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Main.html">Main</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: Int -&gt; <a href="Main.html#t:Menu" title="Main">Menu</a> -&gt; ShowS</p><p class="src"><a href="#v:show">show</a> :: <a href="Main.html#t:Menu" title="Main">Menu</a> -&gt; String</p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Main.html#t:Menu" title="Main">Menu</a>] -&gt; ShowS</p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:estadoInicial" class="def">estadoInicial</a> :: <a href="Main.html#t:Estado" title="Main">Estado</a> <a href="#v:estadoInicial" class="selflink">#</a></p><div class="doc"><h2>Defini&#231;&#227;o geral </h2><p>Estado do jogo. </p><pre>estadoInicial :: Estado 
estadoInicial = (0,0) 
</pre></div></div><div class="top"><p class="src"><a id="v:estadoGlossInicial" class="def">estadoGlossInicial</a> :: [Picture] -&gt; <a href="Main.html#t:EstadoGloss" title="Main">EstadoGloss</a> <a href="#v:estadoGlossInicial" class="selflink">#</a></p><div class="doc"><h2>Defini&#231;&#227;o geral</h2><p>Estado atual do jogo.</p><pre>estadoGlossInicial :: [Picture] -&gt; EstadoGloss
estadoGlossInicial pics@[i, p, b, c, p3O, p3E, p3CE, p3CO, v, s, sel, m1, m2, m3, m4] = (jogo1, estadoInicial, (MainMenu, pics))
</pre></div></div><div class="top"><p class="src"><a id="v:reageEventoGloss" class="def">reageEventoGloss</a> :: Event -&gt; <a href="Main.html#t:EstadoGloss" title="Main">EstadoGloss</a> -&gt; IO <a href="Main.html#t:EstadoGloss" title="Main">EstadoGloss</a> <a href="#v:reageEventoGloss" class="selflink">#</a></p><div class="doc"><h2>Defini&#231;&#227;o geral</h2><p>Mofifica o estado do jogo tendo em conta a tecla permida.</p><pre>reageEventoGloss :: Event -&gt; EstadoGloss -&gt; IO EstadoGloss 

=== Modifica o estado quando este se encontra o menu principal.
reageEventoGloss (EventKey (SpecialKey KeyUp) Down _ _)    (j, (x,y), (MainMenu, pics))
                                                | y == 0    = return (j, (x,(y-240)), (MainMenu, pics))
                                                | otherwise = return (j, (x,(y+80)) , (MainMenu, pics))
reageEventoGloss (EventKey (SpecialKey KeyDown) Down _ _)  (j, (x,y), (MainMenu, pics)) 
                                                | y == (-240) = return (j, (x,0),    (MainMenu, pics)) 
                                                | otherwise   = return (j, (x,y-80), (MainMenu, pics))     
reageEventoGloss (EventKey (SpecialKey KeyEnter) Down _ _) (j, (x,y), (MainMenu, pics))
                                                | y == 0      = return (j, (x,y),    (Jogar, pics))
                                                | y == (-80)  = return (j, (-40,80), (Mapas, pics))
                                                | y == (-160) = return (j, (x,y),    (Instrucoes,  pics))
                                                | y == (-240) = return (j, (x,y),    (Sair, pics))

=== Modifica o estado quando este se encontra no menu dos mapas.
reageEventoGloss (EventKey (SpecialKey KeyDown) Down _ _)    (j, (x,y), (Mapas, pics)) 
                                                | y == 80   = return (j, (x,(-20)), (Mapas, pics))
                                                | otherwise = return (j, (x,80),     (Mapas, pics))
reageEventoGloss (EventKey (SpecialKey KeyUp) Down _ _)    (j, (x,y), (Mapas, pics)) 
                                                | y == 80   = return (j, (x,(-20)), (Mapas, pics))
                                                | otherwise = return (j, (x,80),     (Mapas, pics))
reageEventoGloss (EventKey (SpecialKey KeyLeft) Down _ _)    (j, (x,y), (Mapas, pics))
                                                | x == (-40)  = return (j, ((55),y), (Mapas, pics))
                                                | otherwise = return (j, (-40,y),   (Mapas, pics))
reageEventoGloss (EventKey (SpecialKey KeyRight) Down _ _)    (j, (x,y), (Mapas, pics))
                                                | x == (-40)  = return (j, ((55),y), (Mapas, pics))
                                                | otherwise = return (j, (-40,y),   (Mapas, pics))
reageEventoGloss (EventKey (SpecialKey KeyEnter) Down _ _) (j, (x,y), (Mapas, pics))
                                                | x == (-40) &amp;&amp; y == 80    = return (jogo1, (0,0), (MainMenu, pics))
                                                | x == (-40) &amp;&amp; y == (-20) = return (jogo2, (0,0), (MainMenu, pics))
                                                | x == 55 &amp;&amp; y == 80       = return (jogo3, (0,0), (MainMenu, pics))
                                                | x == 55 &amp;&amp; y == (-20)    = return (jogo4, (0,0), (MainMenu, pics))

=== Modifica o estado quando este se encontra dentro de um dos mapas do jogo.
reageEventoGloss (EventKey (SpecialKey KeyDown)  Down _ _) (jogo<code>(Jogo mapa (Jogador (xs,ys) dir bool)), (x,y), (Jogar, pics)) = return ((moveJogador jogo InterageCaixa), (x, y), (Jogar, pics))                                                                     
reageEventoGloss (EventKey (SpecialKey KeyUp)    Down _ _) (jogo</code>(Jogo mapa (Jogador (xs,ys) dir bool)), (x,y), (Jogar, pics)) 
                                                                                        | (xs+1,ys-1) == p = return (jogo1, estadoInicial, (MainMenu, pics)) 
                                                                                        | (xs-1,ys-1) == p = return (jogo1, estadoInicial, (MainMenu, pics))
                                                                                        | otherwise        = return ((moveJogador jogo Trepar), (x, y), (Jogar, pics))
                                                                                        where p = coordPorta (desconstroiMapa mapa) --^ Determina as coordenadas respetivas da peca, Porta, no mapa.
reageEventoGloss (EventKey (SpecialKey KeyLeft)  Down _ _) (jogo<code>(Jogo mapa (Jogador (xs,ys) dir bool)), (x,y), (Jogar, pics))
                                                                                        | (xs-1,yqO) == p = return (jogo1, estadoInicial, (MainMenu, pics))
                                                                                        | otherwise       = return ((moveJogador jogo AndarEsquerda), (x, y), (Jogar, pics))
                                                                                        where p = coordPorta (desconstroiMapa mapa) --^ Determina as coordenadas respetivas da peca, Porta, no mapa.
                                                                                              yqO = yDoChao (xs-1,ys) (desconstroiMapa mapa) --^ Determina o <code>y</code> respetivo do ch&#227;o do mapa.
reageEventoGloss (EventKey (SpecialKey KeyRight) Down _ _) (jogo</code>(Jogo mapa (Jogador (xs,ys) dir bool)), (x,y), (Jogar, pics))
                                                                                        | (xs+1,yqE) == p = return (jogo1, estadoInicial, (MainMenu, pics))
                                                                                        | otherwise       = return ((moveJogador jogo AndarDireita) , (x, y), (Jogar, pics))
                                                                                        where p = coordPorta (desconstroiMapa mapa) --^ Determina as coordenadas respetivas da peca, Porta, no mapa.
                                                                                              yqE = yDoChao (xs+1,ys) (desconstroiMapa mapa) --^ Determina o <code>y</code> respetivo do ch&#227;o do mapa.

reageEventoGloss (EventKey (SpecialKey KeySpace) Down _ _) jogo<code>(j, (x,y), (Jogar, pics)) =
                              do writeFile &quot;continuar.txt&quot; (show j)            --^ Grava coordenadas em ficheiro ao pressionar tecla <a href="Space.html">Space</a>.
                                 return (j, (x,y), (MainMenu, pics))           --^ Volta ao menu principal com o jogo guardado.

reageEventoGloss (EventKey (SpecialKey KeyF12) Down _ _) jogo</code>(j, (x,y), (s, pics)) --^ Retorna ao menu principal.
                                                | s == MainMenu = return jogo
                                                | otherwise     = return (jogo1, (0,0), (MainMenu, pics))
reageEventoGloss _ s = return s --^ Ignora qualquer outro evento. 
</pre></div></div><div class="top"><p class="src"><a id="v:coordPorta" class="def">coordPorta</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> <a href="#v:coordPorta" class="selflink">#</a></p><div class="doc"><h2>Defini&#231;&#227;o Geral</h2><p>Obt&#234;m as coordenadas da Porta.</p><h2>Defini&#231;&#227;o mais espec&#237;fica</h2><p>A fun&#231;&#227;o <code><a href="Main.html#v:coordPorta" title="Main">coordPorta</a></code> vai correr a lista toda de pe&#231;as at&#233; encontrar uma que respeita as condi&#231;&#245;es apresentadas e, nesse caso d&#225; as coordenadas dessa Peca.</p><h2>Caso de paragem</h2><p>Esta fun&#231;&#227;o n&#227;o tem caso de paragem porque &#233; auxiliar da <code><a href="Main.html#v:reageEventoGloss" title="Main">reageEventoGloss</a></code> e, por isso, o seu caso de paragem est&#225; relacionado com esta fun&#231;&#227;o.</p><pre>coordPorta :: [(Peca,Coordenadas)] -&gt; Coordenadas
coordPorta ((c,(x,y)):t) 
                        | c /= Porta = coordPorta t
                        | otherwise = (x,y)
</pre><h2>Exemplo de utiliza&#231;&#227;o da fun&#231;&#227;o <code><a href="Main.html#v:coordPorta" title="Main">coordPorta</a></code>:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>coordPorta [(Vazio,(0,0)), (Porta,(1,0)), (Vazio,(2,0)), (Vazio,(3,0)), (Vazio,(0,1)),(Bloco,(1,1)), (Vazio, (2,1)), (Vazio, (3,1)), (Vazio,(0,2)) (Bloco,(1,2)), (Bloco,(2,2)), (Bloco, (3,2)), (Bloco,(0,3)), (Bloco,(1,3)), (Bloco,(2,3)), (Bloco,(3,3))] = (1,0)
</code></strong></pre></div></div><div class="top"><p class="src"><a id="v:reageTempoGloss" class="def">reageTempoGloss</a> :: Float -&gt; <a href="Main.html#t:EstadoGloss" title="Main">EstadoGloss</a> -&gt; IO <a href="Main.html#t:EstadoGloss" title="Main">EstadoGloss</a> <a href="#v:reageTempoGloss" class="selflink">#</a></p><div class="doc"><p>&#192; medida que o tempo passa, modifica o estado do jogo.</p></div></div><div class="top"><p class="src"><a id="v:desenhaEstadoGloss" class="def">desenhaEstadoGloss</a> :: <a href="Main.html#t:EstadoGloss" title="Main">EstadoGloss</a> -&gt; IO Picture <a href="#v:desenhaEstadoGloss" class="selflink">#</a></p><div class="doc"><p>Desenha na tela o jogo para que o utilizador possa usufruir do mesmo.</p></div></div><div class="top"><p class="src"><a id="v:desenhaMapa" class="def">desenhaMapa</a> :: <a href="LI12122.html#t:Mapa" title="LI12122">Mapa</a> -&gt; Int -&gt; [Picture] -&gt; [Picture] <a href="#v:desenhaMapa" class="selflink">#</a></p><div class="doc"><h2>Defini&#231;&#227;o geral</h2><p>Desenha o mapa.</p><h2>Defini&#231;&#227;o mais espec&#237;fica</h2><p>Aplicar a fun&#231;&#227;o <code><a href="Main.html#v:desenhaLinha" title="Main">desenhaLinha</a></code> recursivamente at&#233; desenhar o mapa por completo.</p><h2>Caso de paragem</h2><p>A fun&#231;&#227;o acaba quando o mapa &#233; vazio, [].</p><pre>desenhaMapa :: Mapa -&gt; Int -&gt; [Picture] -&gt; [Picture]
desenhaMapa [] y pics = []
desenhaMapa mapa<code>(h:t) y pics</code>[i, p, b, c, p3O, p3E, p3CE, p3CO, v, s, sel, m1, m2, m3, m4] = desenhaMapa t (y-30) pics ++ desenhaLinha h (0,y) (mx,my) pics  --^ S&#227;o retiradas 30 unidades ao valor de <code>y</code> sempre que uma linha chega ao fim para que o mapa n&#227;o fique sobreposto.
                  where mx = (xMax (map snd(desconstroiMapa mapa))) --^ Determina o valor de <code>x</code> m&#225;ximo do mapa.
                        my = (yMax (map snd(desconstroiMapa mapa))) --^ Determina o valor de <code>y</code> m&#225;ximo do mapa.
</pre><h2>Exemplo de utiliza&#231;&#227;o da fun&#231;&#227;o <code><a href="Main.html#v:desenhaMapa" title="Main">desenhaMapa</a></code>:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>desenhaMapa [[Bloco,Vazio,Vazio,Porta], [Bloco, Bloco, Bloco, Bloco]] = [b, v, v, p, b, b, b, b]
</code></strong></pre><h2>Defini&#231;&#227;o geral</h2><p>Desenhar uma linha do mapa.</p><h2>Defini&#231;&#227;o mais espec&#237;fica</h2><p>Atrav&#233;s da recursividade da fun&#231;&#227;o, desenha a linha do mapa que corresponde &#224; lista de pe&#231;as que recebe.</p><h2>Caso de paragem</h2><p>A fun&#231;&#227;o termina quando a lista de pe&#231;as fica vazia, [].</p><pre>desenhaLinha :: [Peca] -&gt; (Int,Int) -&gt; (Int,Int) -&gt; [Picture] -&gt; [Picture]
desenhaLinha [] (x,y) (mx,my) pics = []
desenhaLinha (h:t) (x,y) (mx,my) pics@[i, p, b, c, p3O, p3E, p3CE, p3CO, v, s, sel, m1, m2, m3, m4]
                | h == Porta = desenhaLinha t ((x+60),y) (mx,my) pics ++ [(Translate (x1-max1) (y1+may2) p)]  
                | h == Vazio = desenhaLinha t ((x+60),y) (mx,my) pics ++ [(Translate (x1-max1) (y1+may2) v)]
                | h == Bloco = desenhaLinha t ((x+60),y) (mx,my) pics ++ [(Translate (x1-max1) (y1+may2) b)]
                | h == Caixa = desenhaLinha t ((x+60),y) (mx,my) pics ++ [(Translate (x1-max1) (y1+may2) c)]
              where x1 = fromIntegral x --^ Transforma o <code>x</code> (Int) num <code>xs</code> (Float).
                    y1 = fromIntegral y --^ Transforma o <code>y</code> (Int) num <code>ys</code> (Float).
                    max1 = (fromIntegral mx*60) * (1/2) --^ Torna o mapa centrado ao meio tendo em conta o valor do <code>x</code>.
                    may2 = (fromIntegral my*60) * (1/2) --^ Torna o mapa centrado ao meio tendo em conta o valor do <code>y</code>.
</pre><h2>Exemplo de utiliza&#231;ao da fun&#231;&#227;o <code><a href="Main.html#v:desenhaLinha" title="Main">desenhaLinha</a></code>:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>desenhaLinha [Bloco, Porta, Vazio, Vazio, Vazio] (0,0) (4,0) [i, p, b, c, p3O, p3E, p3CE, p3CO, v, s, sel, m1, m2, m3, m4] = [b, p, v, v]
</code></strong></pre></div></div><div class="top"><p class="src"><a id="v:desenhaLinha" class="def">desenhaLinha</a> :: [<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>] -&gt; (Int, Int) -&gt; (Int, Int) -&gt; [Picture] -&gt; [Picture] <a href="#v:desenhaLinha" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:desenhaJogador" class="def">desenhaJogador</a> :: <a href="Main.html#t:EstadoGloss" title="Main">EstadoGloss</a> -&gt; Picture <a href="#v:desenhaJogador" class="selflink">#</a></p><div class="doc"><h2>Defini&#231;&#227;o geral</h2><p>Desenha o jogador tendo em conta a sua dire&#231;&#227;o e se este est&#225; ou n&#227;o a segurar uma caixa.</p><h2>Caso de paragem</h2><p>Uma vez que um jogo ter&#225; sempre um jogador, esta fun&#231;&#227;o n&#227;o necessita de ter um caso de paragem.</p><pre>desenhaJogador :: EstadoGloss -&gt; Picture
desenhaJogador ((Jogo mapa (Jogador (xs,ys) dir bool)), (x,y), (Jogar, [i, p, b, c, p3O, p3E, p3CE, p3CO, v, s, sel, m1, m2, m3, m4]))
                             | dir == Oeste &amp;&amp; bool == False = Translate ((fromIntegral xs*60)-max1) (-((fromIntegral ys*60)-may2)) p3O
                             | dir == Este  &amp;&amp; bool == False = Translate ((fromIntegral xs*60)-max1) (-((fromIntegral ys*60)-may2)) p3E
                             | dir == Oeste &amp;&amp; bool == True  = Translate ((fromIntegral xs*60)-max1) (-((fromIntegral ys*60)-may2)) p3CO
                             | dir == Este  &amp;&amp; bool == True  = Translate ((fromIntegral xs*60)-max1) (-((fromIntegral ys*60)-may2)) p3CE
                         where  mx = (xMax (map snd(desconstroiMapa mapa))) --^ Determina o <code>x</code> m&#225;ximo do mapa
                                my = (yMax (map snd(desconstroiMapa mapa))) --^ Determina o <code>y</code> m&#225;ximo do mapa
                                max1 = (fromIntegral mx*60) * (1<em>2)  --^ O valor de <code>x</code> &#233; multiplicado pelo tamanho das pe&#231;as definido, 60. Posteriormente, este &#233; multiplicado por 1</em>2 uma vez que, o mapa est&#225; centrado ao meio. 
                                may2 = (fromIntegral my*60) * (1<em>2)  --^ O valor de <code>y</code> &#233; multiplicado pelo tamanho das pe&#231;as definido, 60. Posteriormente, este &#233; multiplicado por 1</em>2 uma vez que, o mapa est&#225; centrado ao meio.                      
</pre><h2>Exemplo de utiliza&#231;&#227;o da fun&#231;&#227;o <code><a href="Main.html#v:desenhaJogador" title="Main">desenhaJogador</a></code>:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>((Jogo [[Vazio, Vazio, Vazio],[Bloco, Bloco, Bloco]] (Jogador (1,0) Este False)), (x,y), (Jogar, [i, p, b, c, p3O, p3E, p3CE, p3CO, v, s, sel, m1, m2, m3, m4])) =  Translate 0 30 p3CE
</code></strong></pre></div></div><div class="top"><p class="src"><a id="v:fr" class="def">fr</a> :: Int <a href="#v:fr" class="selflink">#</a></p><div class="doc"><h2>Defini&#231;&#227;o geral</h2><p>O framerate do jogo, ou seja, &#233; o n&#250;mero de vezes que a fun&#231;&#227;o <code><a href="Main.html#v:reageTempoGloss" title="Main">reageTempoGloss</a></code> &#233; executada num segundo.</p><pre>fr :: Int 
fr = 50
</pre></div></div><div class="top"><p class="src"><a id="v:main" class="def">main</a> :: IO () <a href="#v:main" class="selflink">#</a></p><div class="doc"><h2>Defini&#231;&#227;o geral</h2><p>Faz com que o jogo funcione e permite importar as imagens necess&#225;rias ao seu desenvolvimento.</p><pre>main :: IO ()
main = do 
    --p &lt;- loadBMP &quot;Imagem.bmp&quot;
    Just i    &lt;- loadJuicy &quot;imagens/instrucoes.png&quot;  --^ Imagem das Instru&#231;oes
    Just p    &lt;- loadJuicy &quot;imagens/porta.png&quot;  --^ Imagem da Porta
    Just b    &lt;- loadJuicy &quot;imagens/bloco.png&quot;  --^ Imagem do Bloco
    Just c    &lt;- loadJuicy &quot;imagens/caixa.png&quot;  --^ Imagem da Caixa
    Just p3E  &lt;- loadJuicy &quot;imagens/manE.png&quot;   --^ Imagem do jogador virado para a direita
    Just p3O  &lt;- loadJuicy &quot;imagens/manO.png&quot;   --^ Imagem do jogador virado para a esquerda
    Just p3CE &lt;- loadJuicy &quot;imagens/mancaixaE.png&quot;  --^ Imagem do jogador virado para a direita a segurar uma caixa
    Just p3CO &lt;- loadJuicy &quot;imagens/mancaixaO.png&quot;  --^ Imagem do jogador virado para a esquerda a segurar uma caixa
    Just v    &lt;- loadJuicy &quot;imagens/vazio.png&quot;  --^ Imagem do Vazio
    Just s    &lt;- loadJuicy &quot;imagens/seta.png&quot;   --^ Imagem da seta
    Just sel  &lt;- loadJuicy &quot;imagens/selecionar.png&quot;  --^ Imagem de um quadrado
    Just m1   &lt;- loadJuicy &quot;imagens/mapa1.png&quot;  --^ Imagem do mapa 1
    Just m2   &lt;- loadJuicy &quot;imagens/mapa2.png&quot;  --^ Imagem do mapa 2
    Just m3   &lt;- loadJuicy &quot;imagens/mapa3.png&quot;  --^ Imagem do mapa 3
    Just m4   &lt;- loadJuicy &quot;imagens/mapa4.png&quot;  --^ Imagem do mapa 4
    playIO FullScreen           --^ Janela onde ir&#225; correr o jogo
      (greyN 0.5)               --^ Cor do fundo da janela
      fr                        --^ Frame rate
      (estadoGlossInicial [i, p, b, c, p3O, p3E, p3CE, p3CO, v, s, sel, m1, m2, m3, m4])   --^ Estado inicial
      desenhaEstadoGloss        --^ Fun&#231;&#227;o que desenha o estado do jogo
      reageEventoGloss          --^ Fun&#231;&#227;o que reage a um evento
      reageTempoGloss           --^ Fun&#231;&#227;o que reage ao passar do tempo
</pre></div></div><div class="top"><p class="src"><a id="v:menu" class="def">menu</a> :: [Picture] <a href="#v:menu" class="selflink">#</a></p><div class="doc"><p>Menu inicial do jogo</p></div></div><div class="top"><p class="src"><a id="v:jogo1" class="def">jogo1</a> :: <a href="LI12122.html#t:Jogo" title="LI12122">Jogo</a> <a href="#v:jogo1" class="selflink">#</a></p><div class="doc"><p>Mapas dispon&#237;veis para o jogo</p></div></div><div class="top"><p class="src"><a id="v:mapa1" class="def">mapa1</a> :: [[<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>]] <a href="#v:mapa1" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:jogo2" class="def">jogo2</a> :: <a href="LI12122.html#t:Jogo" title="LI12122">Jogo</a> <a href="#v:jogo2" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:mapa2" class="def">mapa2</a> :: [[<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>]] <a href="#v:mapa2" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:jogo3" class="def">jogo3</a> :: <a href="LI12122.html#t:Jogo" title="LI12122">Jogo</a> <a href="#v:jogo3" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:mapa3" class="def">mapa3</a> :: [[<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>]] <a href="#v:mapa3" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:jogo4" class="def">jogo4</a> :: <a href="LI12122.html#t:Jogo" title="LI12122">Jogo</a> <a href="#v:jogo4" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:mapa4" class="def">mapa4</a> :: [[<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>]] <a href="#v:mapa4" class="selflink">#</a></p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.24.2</p></div></body></html>