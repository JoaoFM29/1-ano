<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Tarefa1_2021li1g043</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption empty">&nbsp;</span><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>Jo&#227;o Magalh&#227;es &lt;a100740@alunos.uminho.pt&gt;;<br />: Gon&#231;alo Loureiro &lt;a100535@alunos.uminho.pt&gt;;</td></tr><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr></table><p class="caption">Tarefa1_2021li1g043</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>M&#243;dulo para a realiza&#231;&#227;o da Tarefa 1 do projeto de LI1 em 2021/22.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:validaPotencialMapa">validaPotencialMapa</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Bool</li><li class="src short"><a href="#v:coordiguais">coordiguais</a> :: [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>] -&gt; Bool</li><li class="src short"><a href="#v:umaPorta">umaPorta</a> :: [<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>] -&gt; Bool</li><li class="src short"><a href="#v:caixaFlutuante">caixaFlutuante</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Bool</li><li class="src short"><a href="#v:xMax">xMax</a> :: [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>] -&gt; Int</li><li class="src short"><a href="#v:yMax">yMax</a> :: [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>] -&gt; Int</li><li class="src short"><a href="#v:linhasMapa">linhasMapa</a> :: Int -&gt; Int -&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>]</li><li class="src short"><a href="#v:linha">linha</a> :: Int -&gt; Int -&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>]</li><li class="src short"><a href="#v:coordVazio">coordVazio</a> :: [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>] -&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>] -&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</li><li class="src short"><a href="#v:constroiMapaPVO">constroiMapaPVO</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</li><li class="src short"><a href="#v:verificaVazio">verificaVazio</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Bool</li><li class="src short"><a href="#v:ordenaPecas">ordenaPecas</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</li><li class="src short"><a href="#v:receberMaioresEMenores">receberMaioresEMenores</a> :: <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; ([(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)], [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)])</li><li class="src short"><a href="#v:coordBloco">coordBloco</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</li><li class="src short"><a href="#v:constroiMapaBVO">constroiMapaBVO</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</li><li class="src short"><a href="#v:consstroiMapaBVO">consstroiMapaBVO</a> :: [a1] -&gt; [a2]</li><li class="src short"><a href="#v:chaoMapa">chaoMapa</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Bool</li><li class="src short"><a href="#v:coordChaoBloco">coordChaoBloco</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Int -&gt; Int -&gt; Bool</li><li class="src short"><a href="#v:chaoBloco">chaoBloco</a> :: (<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>) -&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Bool</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:validaPotencialMapa" class="def">validaPotencialMapa</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Bool <a href="#v:validaPotencialMapa" class="selflink">#</a></p><div class="doc"><h2>Defini&#231;&#227;o geral</h2><p>Valida&#231;&#227;o do mapa atrav&#233;s de v&#225;rias fun&#231;&#245;es acopladas.</p><h2>Defini&#231;&#227;o mais espec&#237;fica</h2><p>A fun&#231;&#227;o validaPotencialMapa ser&#225; utilizada para validar os mapas a partir de v&#225;rias fun&#231;&#245;es que, juntas, cumprem com as regras de um mapa v&#225;lido podendo retornar verdadeiro(mapa v&#225;lido) ou falso(mapa inv&#225;lido).</p><h2>Caso de paragem</h2><p>A fun&#231;&#227;o apenas ir&#225; devolver False quando uma das fun&#231;&#245;es nao for cumprida ou at&#233; quando for dada &#224; mesma uma lista vazia, [].</p><pre>validaPotencialMapa :: [(Peca, Coordenadas)] -&gt; Bool
validaPotencialMapa [] = False              
validaPotencialMapa l = coordiguais (map snd l)  
                     &amp;&amp; umaPorta (map fst l)
                     &amp;&amp; caixaFlutuante l l
                     &amp;&amp; verificaVazio l
                     &amp;&amp; chaoMapa l 
</pre><h2>Exemplos de utiliza&#231;&#227;o da fun&#231;&#227;o <code><a href="Tarefa1_2021li1g043.html#v:validaPotencialMapa" title="Tarefa1_2021li1g043">validaPotencialMapa</a></code>:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>ValidaPotencialMapa [(Porta,(0,0)),(Caixa,(1,0)),(Bloco,(0,1)),(Bloco,(1,1)),(Bloco,(2,1))]
</code></strong>True
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>ValidaPotencialMapa [(Porta,(0,0)),(Caixa,(1,0)),(Bloco,(0,1)),(Porta,(0,1)),(Bloco,(2,1))]
</code></strong>False
</pre></div></div><div class="top"><p class="src"><a id="v:coordiguais" class="def">coordiguais</a> :: [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>] -&gt; Bool <a href="#v:coordiguais" class="selflink">#</a></p><div class="doc"><h2>Defini&#231;&#227;o geral</h2><p>Verificar se h&#225; coordenadas iguais.</p><h2>Defini&#231;&#227;o mais espec&#237;fica</h2><p>Esta fun&#231;&#227;o a seguir apresentada tem como objetivo principal verificar a repeti&#231;&#227;o de alguma coordenada podendo retornar verdadeiro(coordenadas todas diferentes) ou falso(pelo menos uma coordenada igual).</p><h2>Caso de paragem</h2><p>O caso de paragem de <code><a href="Tarefa1_2021li1g043.html#v:coordiguais" title="Tarefa1_2021li1g043">coordiguais</a></code> &#233; dado apenas quando a fun&#231;&#227;o &#233; vazia, [], e nesse caso, devolve False. Quando a lista &#233; percorrida totalmente sem apresentar coordenadas iguais, ao chegar &#224; ultima pe&#231;a devolve True uma vez que, nada &#233; igual &#224;quela pe&#231;a.</p><pre>coordiguais :: [Coordenadas] -&gt; Bool 
coordiguais [] = False
coordiguais [coor1] = True
coordiguais (coor1:tc) =  if elem(coor1) tc then False else coordiguais tc
</pre><h2>Exemplos de utiliza&#231;&#227;o da fun&#231;&#227;o <code><a href="Tarefa1_2021li1g043.html#v:coordiguais" title="Tarefa1_2021li1g043">coordiguais</a></code>:</h2><p>coordiguais [(0,0),(1,0),(3,2),(0,0)]
&gt;&gt;&gt; False</p><p>coordiguais [(0,0),(1,0),(3,2),(5,1)]
&gt;&gt;&gt; True  </p></div></div><div class="top"><p class="src"><a id="v:umaPorta" class="def">umaPorta</a> :: [<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>] -&gt; Bool <a href="#v:umaPorta" class="selflink">#</a></p><div class="doc"><h2>Defini&#231;&#227;o geral</h2><p>Verificar se h&#225; mais do que uma porta no mapa.</p><h2>Defini&#231;&#227;o mais espec&#237;fica</h2><p>A fun&#231;&#227;o <code><a href="Tarefa1_2021li1g043.html#v:umaPorta" title="Tarefa1_2021li1g043">umaPorta</a></code> ir&#225; percorrer a lista toda at&#233; encontrar uma Porta, depois averigua se h&#225; mais alguma Porta na restante lista, caso nao exista, a fun&#231;&#227;o retorna True.</p><h2>Caso de paragem  </h2><p>O caso de paragem desta fun&#231;&#227;o em baixo descrita &#233; dado pela lista vazia, [], uma vez que, a fun&#231;&#227;o percorre a lista at&#233; encontrar alguma Porta, no caso de n&#227;o encontrar, devolve False.</p><pre>umaPorta :: [Peca] -&gt; Bool 
umaPorta [] = False
umaPorta (p1 : tp) 
                  | p1 == Porta &amp;&amp; (elem(Porta) tp) = False
                  | p1 /= Porta = umaPorta tp  
                  | otherwise = True
</pre><h2>Exemplos de utiliza&#231;&#227;o da fun&#231;&#227;o <code><a href="Tarefa1_2021li1g043.html#v:umaPorta" title="Tarefa1_2021li1g043">umaPorta</a></code>:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>umaPorta [Porta,Bloco,Caixa,Porta]
</code></strong>False
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>umaPorta [Caixa,Bloco,Porta,Bloco]
</code></strong>True 
</pre></div></div><div class="top"><p class="src"><a id="v:caixaFlutuante" class="def">caixaFlutuante</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Bool <a href="#v:caixaFlutuante" class="selflink">#</a></p><div class="doc"><h2>Defini&#231;&#227;o geral   </h2><p>Verificar se h&#225; alguma caixa flutuante no mapa.</p><h2>Defini&#231;&#227;o mais espec&#237;fica</h2><p>O objetivo desta fun&#231;&#227;o &#233; aferir se h&#225; alguma caixa ou bloco na posi&#231;&#227;o abaixo da caixa avan&#231;ando a lista sempre que esta condi&#231;&#227;o se verificar. </p><h2>Caso de paragem</h2><p>O caso de paragem desta fun&#231;&#227;o &#233; dado pela rece&#231;&#227;o de uma lista vazia, [] ou ent&#227;o at&#233; encontrar mais do que uma Porta que por sua vez, devolve False sen&#227;o retorna True. </p><pre>caixaFlutuante :: [(Peca, Coordenadas)] -&gt; [(Peca,Coordenadas)] -&gt; Bool 
caixaFlutuante [] l = True 
caixaFlutuante ((c,(x,y)):t) l
                       | c == Caixa &amp;&amp; elem (Bloco,(x,y+1)) l = caixaFlutuante t l
                       | c == Caixa &amp;&amp; elem (Caixa,(x,y+1)) l = caixaFlutuante t l 
                       | c == Caixa &amp;&amp; not(elem (Caixa,(x,y+1)) l) = False 
                       | c == Caixa &amp;&amp; not(elem (Bloco,(x,y+1)) l) = False
                       | otherwise = caixaFlutuante t l
</pre><h2>Exemplos de utiliza&#231;&#227;o da fun&#231;&#227;o <code><a href="Tarefa1_2021li1g043.html#v:caixaFlutuante" title="Tarefa1_2021li1g043">caixaFlutuante</a></code>:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>caixaFlutuante [(Porta,(0,0)),(Caixa,(1,0)),(Bloco,(0,1)),(Bloco,(2,1))]
</code></strong>False
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>caixaFlutuante [(Porta,(0,0)),(Caixa,(1,0)),(Bloco,(0,1)),(Caixa,(1,1)),(Bloco,(1,2))]
</code></strong>True  
</pre></div></div><div class="top"><p class="src"><a id="v:xMax" class="def">xMax</a> :: [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>] -&gt; Int <a href="#v:xMax" class="selflink">#</a></p><div class="doc"><h2>Defini&#231;&#227;o global da jun&#231;&#227;o das duas fun&#231;&#245;es</h2><p>Fun&#231;&#245;es auxiliares que encontram a abcissa e a ordenada m&#225;xima do mapa para poderem, posteriormente, ser aplicadas nas fun&#231;&#245;es que ir&#227;o aparecer. </p><h2>Caso de paragem</h2><p>Uma vez que estas fun&#231;&#245;es nunca seram utilizadas sozinhas, o seu caso de paragem vai de encontro com o caso de paragem na fun&#231;&#227;o a que est&#227;o a auxliar.</p><ol><li>Devolve o valor de <code>x</code> m&#225;ximo atrav&#233;s da compara&#231;&#227;o das abcissas das coordenadas </li></ol><pre>xMax :: [Coordenadas] -&gt; Int
xMax [(x,y)] = x
xMax ((x,y):(xs,ys):t) = if x &gt;= xs then xMax ((x,y):t) else xMax ((xs,ys):t)
</pre><ol><li>Devolve o valor de <code>y</code> m&#225;ximo atrav&#233;s da compara&#231;&#227;o das ordenadas </li></ol><pre>yMax :: [Coordenadas] -&gt; Int
yMax [(x,y)] = y
yMax ((x,y):(xs,ys):t) = if y &gt;= ys then yMax((x,y):t) else yMax ((xs,ys):t)
</pre><h2>Exemplo de utiliza&#231;&#227;o da fun&#231;&#227;o <code><a href="Tarefa1_2021li1g043.html#v:xMax" title="Tarefa1_2021li1g043">xMax</a></code> e <code><a href="Tarefa1_2021li1g043.html#v:yMax" title="Tarefa1_2021li1g043">yMax</a></code>, respetivamente:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>xMax [(0,0),(2,0),(3,2),(1,0)]
</code></strong>3
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>yMax [(0,0),(2,0),(3,2),(1,0)]
</code></strong>2
</pre></div></div><div class="top"><p class="src"><a id="v:yMax" class="def">yMax</a> :: [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>] -&gt; Int <a href="#v:yMax" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:linhasMapa" class="def">linhasMapa</a> :: Int -&gt; Int -&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>] <a href="#v:linhasMapa" class="selflink">#</a></p><div class="doc"><h2>Defini&#231;&#227;o geral </h2><p>Constru&#231;&#227;o das linhas do mapa.</p><h2>Defini&#231;&#227;o mais espec&#237;fica</h2><p>Constroi uma lista com todas as coordenadas que o mapa pode ter dadas as suas dimen&#231;&#245;es <code>x</code> e <code>y</code>.</p><h2>Caso de paragem</h2><p>Nestas fun&#231;&#245;es uma vez que, estamos a falar de coordenadas de um mapa, n&#227;o faz sentido coordenadas negativas logo, o caso de paragem das fun&#231;&#245;es <code>linhaMapa</code> e <code><a href="Tarefa1_2021li1g043.html#v:linha" title="Tarefa1_2021li1g043">linha</a></code> &#233; quando o y&lt;0 e x&lt; 0, respetivamente.</p><ol><li>Enquanto que y &gt;= 0, a fun&#231;&#227;o ir&#225; chamar a fun&#231;&#227;o <code><a href="Tarefa1_2021li1g043.html#v:linha" title="Tarefa1_2021li1g043">linha</a></code> para um dado valor de <code>x</code>, subtraindo sempre o valor &quot;1&quot; por cada linha </li></ol><pre>linhasMapa :: Int -&gt; Int -&gt; [Coordenadas]
linhasMapa x y
               | (y &gt;= 0) = linhasMapa x (y-1) ++ linha x y  
               | otherwise = [] 
</pre><h2>Exemplo de utiliza&#231;&#227;o da fun&#231;&#227;o <code><a href="Tarefa1_2021li1g043.html#v:linhasMapa" title="Tarefa1_2021li1g043">linhasMapa</a></code>:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>linhasMapa 2 2
</code></strong>[(0,0),(1,0),(2,0),(0,1),(1,1),(2,1),(0,2),(1,2),(2,2)]
</pre><ol><li>Enquanto que x &gt;= 0 a fun&#231;&#227;o ir&#225; devolver uma lista de coordenadas do tipo (x,y), subtra&#237;ndo sempre o valor &quot;1&quot; a cada coordenada dada (come&#231;ando na &#250;ltima coordenada da linha), sendo o <code>y</code> constante em toda a linha</li></ol><pre>linha :: Int -&gt; Int -&gt; [Coordenadas]
linha x y
            | (x &gt;= 0) = linha (x-1) y ++ [(x,y)]
            | otherwise = [] 
</pre><h2>Exemplo de utiliza&#231;&#227;o da fun&#231;&#227;o <code><a href="Tarefa1_2021li1g043.html#v:linha" title="Tarefa1_2021li1g043">linha</a></code>:</h2><p>A fun&#231;&#227;o sozinha neste caso n&#227;o tem muita utilidade no entanto, quando junta &#224; fun&#231;&#227;o <code><a href="Tarefa1_2021li1g043.html#v:linhasMapa" title="Tarefa1_2021li1g043">linhasMapa</a></code> &#233; poss&#237;vel obter in&#250;meros resultados. Um dos exemplos da sua combina&#231;&#227;o est&#225; referido em cima.</p></div></div><div class="top"><p class="src"><a id="v:linha" class="def">linha</a> :: Int -&gt; Int -&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>] <a href="#v:linha" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:coordVazio" class="def">coordVazio</a> :: [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>] -&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>] -&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] <a href="#v:coordVazio" class="selflink">#</a></p><div class="doc"><h2>Defini&#231;&#227;o geral</h2><p>Devolve uma lista de Vazios omitidos na lista <code>l</code>.</p><h2>Defini&#231;&#227;o mais espec&#237;fica</h2><p>Esta fun&#231;&#227;o tem como objetivo auxiliar a fun&#231;&#227;o que ser&#225; apresentada logo ap&#243;s esta, devolvendo todas as pecas que est&#227;o omitidas, ou seja, que n&#227;o s&#227;o escritas, sendo assim compreendidas como (Vazio,(x,y)).</p><h2>Caso de paragem</h2><p>A fun&#231;&#227;o tem como caso de paragem quando uma das duas listas recebidas &#233; vazia, []. </p><pre>coordVazio :: [Coordenadas] -&gt; [Coordenadas] -&gt; [(Peca,Coordenadas)]
coordVazio _ [] = []
coordVazio [] _ = []
coordVazio ((x,y):t) l = if elem(x,y) l then coordVazio t l else (Vazio,(x,y)) : coordVazio t l
</pre><h2>Exemplo de utiliza&#231;&#227;o da fun&#231;&#227;o coordVazio</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>coordVazio [(0,0), (1,0), (0,1), (1,1)] [(0,0), (1,1)]
</code></strong>[(Vazio,(1,0)), (Vazio,(0,1))]
</pre></div></div><div class="top"><p class="src"><a id="v:constroiMapaPVO" class="def">constroiMapaPVO</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] <a href="#v:constroiMapaPVO" class="selflink">#</a></p><div class="doc"><h2>Defini&#231;&#227;o geral</h2><p>Constroi um mapa ordenado com as pe&#231;as omitidas.</p><h2>Defini&#231;&#227;o mais espec&#237;fica</h2><p>Constroi o mapa ordenado,auxiliada pela fun&#231;&#227;o <code><a href="Tarefa1_2021li1g043.html#v:ordenaPecas" title="Tarefa1_2021li1g043">ordenaPecas</a></code>, de pe&#231;as do tipo Vazio, omitidas, utilizando a fun&#231;&#227;o <code><a href="Tarefa1_2021li1g043.html#v:coordVazio" title="Tarefa1_2021li1g043">coordVazio</a></code> para, posteriormente, verificar se h&#225; pecas Vazio no mapa.</p><h2>Caso de paragem</h2><p>A fun&#231;&#227;o tem apenas como caso de paragem a lista vazia, [].</p><pre>constroiMapaPVO :: [(Peca,Coordenadas)] -&gt; [(Peca,Coordenadas)]
constroiMapaPVO ((c,(x,y)):t) = ordenaPecas(coordVazio (linhasMapa xmax ymax) (map snd((c,(x,y)):t)) ++ ((c,(x,y)):t))
                  where xmax = xMax (map snd ((c,(x,y)):t))
                        ymax = yMax (map snd ((c,(x,y)):t))
</pre><h2>Exemplo de utilidade da fun&#231;&#227;o <code><a href="Tarefa1_2021li1g043.html#v:constroiMapaPVO" title="Tarefa1_2021li1g043">constroiMapaPVO</a></code>:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>constroiMapaPVO [(Bloco,(0,1)),(Porta,(1,1))]
</code></strong>[(Vazio,(0,0)), (Vazio,(1,0)), (Bloco,(0,1)), (Porta,(1,1))]
</pre></div></div><div class="top"><p class="src"><a id="v:verificaVazio" class="def">verificaVazio</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Bool <a href="#v:verificaVazio" class="selflink">#</a></p><div class="doc"><h2>Defini&#231;&#227;o geral</h2><p>Verifica se o mapa tem espa&#231;os vazios (pecas = Vazio).</p><h2>Defini&#231;&#227;o mais espec&#237;fica</h2><p>A fun&#231;&#227;o ir&#225; avaliar se a lista de Pecas cont&#234;m alguma que &#233; igual a Vazio atrav&#233;s da utiliza&#231;&#227;o de duas fun&#231;&#245;es de ordem superior, <code>any</code>, &#224; primeira parcela do resultado da fun&#231;ao constroiMapaPVO, dado pelo 'map fst'.</p><h2>Caso de paragem</h2><p>No caso de nenhuma pe&#231;a ser igual a Vazio a fun&#231;&#227;o ir&#225; retornar False, caso contr&#225;rio, True.</p><pre>verificaVazio :: [(Peca,Coordenadas)] -&gt; Bool
verificaVazio [] = []
verificaVazio l = any (Vazio ==) (map fst(constroiMapaPVO l))
</pre><h2>Exemplos de utiliza&#231;&#227;o da fun&#231;&#227;o <code><a href="Tarefa1_2021li1g043.html#v:verificaVazio" title="Tarefa1_2021li1g043">verificaVazio</a></code>:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>verificaVazio [(Bloco,(0,0)), (Porta,(1,1)), (Bloco,(0,1))]
</code></strong>True
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>verificaVazio [(Bloco,(0,0)), (Caixa,(1,0)), (Porta,(1,1)), (Bloco,(0,1))]
</code></strong>False 
</pre></div></div><div class="top"><p class="src"><a id="v:ordenaPecas" class="def">ordenaPecas</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] <a href="#v:ordenaPecas" class="selflink">#</a></p><div class="doc"><h2>Defin&#231;&#227;o geral</h2><p>Ordenar uma lista do tipo (Peca,Coordenada).</p><h2>Defini&#231;&#227;o mais espec&#237;fica</h2><p>Com o aux&#237;lio da fun&#231;&#227;o que ser&#225; apresentada de seguida, ordena uma lista do tipo (Peca,Coordenada) tendo em conta as suas coordenadas.</p><h2>Caso de paragem</h2><p>A fun&#231;&#227;o <code><a href="Tarefa1_2021li1g043.html#v:ordenaPecas" title="Tarefa1_2021li1g043">ordenaPecas</a></code> ir&#225; devolver vazio, [],  quando receber uma lista vazia, [], caso constr&#225;rio ir&#225; devolver a lista recebida ordenadamente.</p><pre>ordenaPecas :: [(Peca,Coordenadas)] -&gt; [(Peca,Coordenadas)]
ordenaPecas [] = []
ordenaPecas ((c,(x,y)):t) = ordenaPecas menores ++ (c,(x,y)) : ordenaPecas maiores 
                where (menores,maiores) = receberMaioresEMenores (x,y) t 
</pre><h2>Exemplo de utiliza&#231;&#227;o da fun&#231;&#227;o <code><a href="Tarefa1_2021li1g043.html#v:ordenaPecas" title="Tarefa1_2021li1g043">ordenaPecas</a></code>:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>ordenaPecas [(Bloco,(0,2)),(Bloco,(1,1)),(Bloco,(2,3)),(Caixa,(1,0))]
</code></strong>[(Caixa,(1,0)),(Bloco,(1,1)),(Bloco,(0,2)),(Bloco,(2,3))]
</pre><ol><li>Esta fun&#231;&#227;o abaixo apresentada tem como objetivo, auxiliar a fun&#231;&#227;o em cima mencionada, ordenando as pe&#231;as de forma crescente repartindo a lista em uma par de listas onde dependendo da compara&#231;&#227;o que &#233; feita com a (Peca, Coordenada) v&#227;o para um dos lados do par.</li></ol><h2>Caso de paragem</h2><p>O caso de paragem desta fun&#231;&#227;o &#233; dado quando <code><a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a></code> &#233; comparado a uma lista vazia, [].</p><pre>receberMaioresEMenores :: Coordenadas -&gt; [(Peca,Coordenadas)] -&gt; ([(Peca,Coordenadas)],[(Peca,Coordenadas)])
receberMaioresEMenores x [] = ([],[])
receberMaioresEMenores (valorX, valorY) ((c,(x,y)):t)
            | y &lt; valorY || (y == valorY &amp;&amp; x &lt; valorX) = ((c,(x,y)):as,bs)
            | y &gt; valorY || (y == valorY &amp;&amp; x &gt; valorX) = (as,(c,(x,y)):bs)
            | otherwise = (as,bs)
            where (as,bs) = receberMaioresEMenores (valorX, valorY) t
</pre><h2>Exemplo de utiliza&#231;&#227;o da fun&#231;&#227;o <code><a href="Tarefa1_2021li1g043.html#v:receberMaioresEMenores" title="Tarefa1_2021li1g043">receberMaioresEMenores</a></code>:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>receberMaioresEMenores (1,1) [(Porta,(0,0)), (Bloco,(1,2)), (Bloco,(1,0)), (Caixa,(2,2))]
</code></strong>([(Porta,(0,0)),(Bloco,(1,0))], [(Bloco,(1,2)),(Caixa,(2,2))])
</pre></div></div><div class="top"><p class="src"><a id="v:receberMaioresEMenores" class="def">receberMaioresEMenores</a> :: <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; ([(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)], [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]) <a href="#v:receberMaioresEMenores" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:coordBloco" class="def">coordBloco</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] <a href="#v:coordBloco" class="selflink">#</a></p><div class="doc"><h2>Defini&#231;&#227;o geral</h2><p>Armazenar as pecas do tipo (Blocos,(x,y))</p><h2>Defini&#231;&#227;o mais espec&#237;fica</h2><p>Armazena apenas as Pecas que s&#227;o igual a Bloco juntamente com as suas coordenadas, sendo &#250;til em fun&#231;&#245;es seguintes.</p><h2>Caso de paragem</h2><p>A fun&#231;&#227;o ir&#225; terminar quando a lista ficar vazia, [].</p><pre>coordBloco :: [(Peca,Coordenadas)] -&gt; [(Peca,Coordenadas)]
coordBloco [] = []
coordBloco ((c,(x,y)):t) 
                        | c /= Bloco = coordBloco t
                        | otherwise = (c,(x,y)) : coordBloco t
</pre><h2>Exemplo de utiliza&#231;&#227;o da fun&#231;&#227;o <code><a href="Tarefa1_2021li1g043.html#v:coordBloco" title="Tarefa1_2021li1g043">coordBloco</a></code>:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>coordBloco [(Bloco,(0,0)), (Caixa,(1,0)), (Caixa,(2,0)), (Bloco,(1,1))]
</code></strong>[(Bloco,(0,0)), (Bloco,(1,1))]
</pre></div></div><div class="top"><p class="src"><a id="v:constroiMapaBVO" class="def">constroiMapaBVO</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] <a href="#v:constroiMapaBVO" class="selflink">#</a></p><div class="doc"><h2>Defini&#231;&#227;o geral</h2><p>Constroi um mapa apenas com Blocos e Vazios ordenado.</p><h2>Defini&#231;&#227;o mais espec&#237;fica</h2><p>Atrav&#233;s da jun&#231;&#227;o das fun&#231;&#245;es <code><a href="Tarefa1_2021li1g043.html#v:coordBloco" title="Tarefa1_2021li1g043">coordBloco</a></code> e <code><a href="Tarefa1_2021li1g043.html#v:constroiMapaPVO" title="Tarefa1_2021li1g043">constroiMapaPVO</a></code> obtemos um mapa constitu&#237;do por pecas do tipo, (Bloco,(x,y)) e (Vazio,(x,y)), ordenado com o intuito de facilitar tarefas seguintes.</p><h2>Caso de paragem</h2><p>Esta fun&#231;&#227;o tem apenas como caso de paragem a lista vazia, [].</p><pre>constroiMapaBVO :: [(Peca,Coordenadas)] -&gt; [(Peca,Coordenadas)]
constroiMapa BVO [] = []
constroiMapaBVO l = constroiMapaPVO(coordBloco l)
</pre><h2>Exemplo de utiliza&#231;&#227;o da fun&#231;&#227;o <code><a href="Tarefa1_2021li1g043.html#v:constroiMapaBVO" title="Tarefa1_2021li1g043">constroiMapaBVO</a></code>:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>consstroiMapaBVO [(Bloco,(2,0)),(Caixa,(1,0))]
</code></strong>[(Vazio,(0,0)),(Vazio,(1,0)),(Bloco,(2,0))]
</pre></div></div><div class="top"><p class="src"><a id="v:consstroiMapaBVO" class="def">consstroiMapaBVO</a> :: [a1] -&gt; [a2] <a href="#v:consstroiMapaBVO" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:chaoMapa" class="def">chaoMapa</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Bool <a href="#v:chaoMapa" class="selflink">#</a></p><div class="doc"><h2>Defini&#231;&#227;o geral</h2><p>Examina se a lista fornecida constitui um ch&#227;o v&#225;lido.</p><h2>Defini&#231;&#227;o mais espec&#237;fica</h2><p>Ao acoplar a fun&#231;&#227;o <code><a href="Tarefa1_2021li1g043.html#v:constroiMapaBVO" title="Tarefa1_2021li1g043">constroiMapaBVO</a></code> &#224; <code><a href="Tarefa1_2021li1g043.html#v:coordChaoBloco" title="Tarefa1_2021li1g043">coordChaoBloco</a></code> e respetivas coordenadas m&#225;ximas, dadas pelas fun&#231;&#245;es 'xMax e yMax', obtemos um resultado, True ou False, dependendo se a lista corresponde ou n&#227;o a um ch&#227;o v&#225;lido.</p><pre>chaoMapa :: [(Peca,Coordenadas)] -&gt; Bool
chaoMapa l = coordChaoBloco (constroiMapaBVO l) xm ym
             where xm = xMax (map snd l)
                   ym = yMax (map snd l)
</pre><h2>Exemplos de utiliza&#231;&#227;o da fun&#231;&#227;o <code><a href="Tarefa1_2021li1g043.html#v:chaoMapa" title="Tarefa1_2021li1g043">chaoMapa</a></code>:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>[ (Porta,(0,0)), (Bloco,(0,1)), (Caixa,(1,1)), (Bloco,(3,1)), (Bloco,(0,2)), (Bloco,(1,2)), (Bloco,(2,2)) ]
</code></strong>True
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>[ (Porta,(0,0)), (Bloco,(0,1)), (Bloco,(0,2)), (Bloco,(1,2)), (Bloco,(1,3)), (Bloco,(2,3)), (Bloco,(3,3)), (Bloco,(4,1)), (Bloco,(2,0)) ]
</code></strong>False  
</pre><ol><li>A fun&#231;&#227;o abaixo apresentada serve de aux&#237;lio &#224; fun&#231;&#227;o principal, <code><a href="Tarefa1_2021li1g043.html#v:chaoMapa" title="Tarefa1_2021li1g043">chaoMapa</a></code>, verificando se existe algum bloco nas coordenadas m&#225;ximas do mapa, caso constr&#225;rio, sobe uma posi&#231;&#227;o para cima (subtra&#237; &quot;1&quot; ao valor do <code>y</code> m&#225;ximo) at&#233; encontrar um Bloco.</li></ol><h2>Caso de paragem </h2><p>A fun&#231;&#227;o ir&#225; parar at&#233; que seja encontrado um bloco na coluna do <code>x</code> m&#225;ximo do mapa.</p><pre>coordChaoBloco :: [(Peca,Coordenadas)] -&gt; Int -&gt; Int -&gt; Bool
coordChaoBloco [] xmax ymax = False
coordChaoBloco ((b,(x,y)):t) xmax ymax
                                 | elem(b,(xmax,ymax)) ((b,(x,y)):t) = chaoBloco (b,(xmax,ymax)) ((b,(x,y)):t)
                                 | otherwise = coordChaoBloco ((b,(x,y)):t) xmax (ymax-1)
                             where b = Bloco
</pre><h2>Exemplos da utiliza&#231;&#227;o da fun&#231;&#227;o <code><a href="Tarefa1_2021li1g043.html#v:coordChaoBloco" title="Tarefa1_2021li1g043">coordChaoBloco</a></code>:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>coordChaoBloco [(Porta,(0,0)),(Bloco,(0,3)),(Bloco,(2,0))] 2 2
</code></strong>False  
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>coordChaoBloco [(Porta,(0,0)),(Bloco,(0,3)),(Bloco,(2,0))] 2 2
</code></strong>True
</pre><ol><li>Quando for encontrado um bloco (atrav&#233;s da fun&#231;&#227;o desenvolvida anteriormente), examina se h&#225; blocos consecutivos que constituem um ch&#227;o verdadeiro ao longo do mapa</li></ol><h2>Caso de paragem </h2><p>A fun&#231;&#227;o ir&#225; parar quando algum bloco pertencer a um conjunto de blocos continuos e estiver situado na lateral oposta &#224; da coordenada m&#225;xima do mapa.</p><pre>chaoBloco :: (Peca,Coordenadas) -&gt; [(Peca,Coordenadas)] -&gt; Bool
chaoBloco (b,(0,ym)) l = True
chaoBloco (b,(xm,ym)) l
                   | elem(b,(xm-1,ym)) l    = chaoBloco (b,(xm-1,ym)) l
                   | elem(b,(xm-1,ym-1)) l  = chaoBloco (b,(xm-1,ym-1)) l 
                   | elem(b,(xm-1,ym+1)) l  = chaoBloco (b,(xm-1,ym+1)) l
                   | otherwise = False
</pre><h2>Exemplos de utiliza&#231;&#227;o da fun&#231;&#227;o <code><a href="Tarefa1_2021li1g043.html#v:chaoBloco" title="Tarefa1_2021li1g043">chaoBloco</a></code>:</h2><p>A fun&#231;&#227;o n&#227;o tem sentido quando utilizada sozinha logo, um exemplo de utiliza&#231;&#227;o da mesma est&#225; relacionado com a fun&#231;&#227;o supramencionada.</p></div></div><div class="top"><p class="src"><a id="v:coordChaoBloco" class="def">coordChaoBloco</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Int -&gt; Int -&gt; Bool <a href="#v:coordChaoBloco" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:chaoBloco" class="def">chaoBloco</a> :: (<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>) -&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Bool <a href="#v:chaoBloco" class="selflink">#</a></p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.24.2</p></div></body></html>